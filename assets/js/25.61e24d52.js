(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{363:function(t,a,s){"use strict";s.r(a);var e=s(34),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"configuring-kuberlogic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-kuberlogic","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuring KuberLogic")]),t._v(" "),s("h2",{attrs:{id:"using-docker-compose-to-provide-your-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker-compose-to-provide-your-application","aria-hidden":"true"}},[t._v("#")]),t._v(" Using docker-compose to provide your application")]),t._v(" "),s("p",[t._v("KuberLogic provides a simple way to deploy your application as SaaS by supporting "),s("code",[t._v("docker-compose.yaml")]),t._v(" structure.")]),t._v(" "),s("h3",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuration")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),s("p",[t._v("KuberLogic only supports a single application type configured via docker-compose.yaml. Any change to this file will be propagated to all KuberLogic managed applications.")])]),s("p",[t._v("To add your application just put the contents of your application's "),s("code",[t._v("docker-compose.yml")]),t._v(" into "),s("code",[t._v("modules/dynamic-operator/config/manager/docker-compose.yaml")])]),t._v(" "),s("h3",{attrs:{id:"limitations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#limitations","aria-hidden":"true"}},[t._v("#")]),t._v(" Limitations")]),t._v(" "),s("p",[t._v("There are few limitations about supported docker-compose.yaml:")]),t._v(" "),s("h4",{attrs:{id:"only-one-service-can-have-its-ports-published"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#only-one-service-can-have-its-ports-published","aria-hidden":"true"}},[t._v("#")]),t._v(" Only one service can have its ports published")]),t._v(" "),s("p",[s("strong",[t._v("Will work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Will not work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n")])])]),s("h4",{attrs:{id:"only-a-single-port-can-be-published"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#only-a-single-port-can-be-published","aria-hidden":"true"}},[t._v("#")]),t._v(" Only a single port can be published.")]),t._v(" "),s("p",[s("strong",[t._v("Will work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Will not work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8081:8081"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n")])])]),s("h4",{attrs:{id:"local-volume-mounts-are-not-supported"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-volume-mounts-are-not-supported","aria-hidden":"true"}},[t._v("#")]),t._v(" Local volume mounts are not supported")]),t._v(" "),s("p",[s("strong",[t._v("Will work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/data\n")])])]),s("p",[s("strong",[t._v("Will not work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/data\n")])])]),s("h3",{attrs:{id:"supported-docker-compose-extensions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#supported-docker-compose-extensions","aria-hidden":"true"}},[t._v("#")]),t._v(" Supported docker-compose extensions")]),t._v(" "),s("p",[t._v("You can use the following extensions to your docker-compose.yaml:")]),t._v(" "),s("h4",{attrs:{id:"x-kuberlogic-access-http-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#x-kuberlogic-access-http-path","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("code",[t._v("x-kuberlogic-access-http-path")])]),t._v(" "),s("p",[t._v("This extension allows you to expose more than one "),s("code",[t._v("docker-compose")]),t._v(" service by specifying HTTP path prefixes. Default path prefix is "),s("code",[t._v("/")]),t._v(".")]),t._v(" "),s("p",[t._v("Duplicates are not allowed and will trigger a service provisioning error.")]),t._v(" "),s("p",[s("strong",[t._v("Will work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" api "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This will be exposed at `/api`")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("x-kuberlogic-access-http-path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /api\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This will be exposed on `/`")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Will not work:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" api "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This will be exposed at `/api`")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("x-kuberlogic-access-http-path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /api\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Duplicate HTTP path prefix!")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("x-kuberlogic-access-http-path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /api\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n")])])]),s("h3",{attrs:{id:"templating-docker-compose-yaml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#templating-docker-compose-yaml","aria-hidden":"true"}},[t._v("#")]),t._v(" Templating "),s("code",[t._v("docker-compose.yaml")])]),t._v(" "),s("p",[t._v("KuberLogic also supports templating certain service fields in "),s("code",[t._v("docker-compose.yaml")]),t._v(" by using Go templates.")]),t._v(" "),s("p",[t._v("Fields that can be templated are:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("image")])]),t._v(" "),s("li",[s("code",[t._v("command")])]),t._v(" "),s("li",[s("code",[t._v("environment")]),t._v(" variables' values")])]),t._v(" "),s("p",[t._v("Service parameters that can be accessed in the template are:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("Name")]),t._v(": The name of the service")]),t._v(" "),s("li",[s("code",[t._v("Namespace")]),t._v(": The namespace of the service")]),t._v(" "),s("li",[s("code",[t._v("Host")]),t._v(": The host of the service")]),t._v(" "),s("li",[s("code",[t._v("Replicas")]),t._v(": The number of replicas of the service")]),t._v(" "),s("li",[s("code",[t._v("VolumeSize")]),t._v(": The size of the volume of the service")]),t._v(" "),s("li",[s("code",[t._v("Version")]),t._v(": The version of the service")]),t._v(" "),s("li",[s("code",[t._v("TLSEnabled")]),t._v(": Whether the service is TLS enabled")]),t._v(" "),s("li",[s("code",[t._v("Parameters")]),t._v(": The advanced parameters of the service")])]),t._v(" "),s("p",[t._v("There are also a few functions that can be used for environment variables:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v(".Endpoint")]),t._v(": Returns the endpoint of the service")]),t._v(" "),s("li",[s("code",[t._v(".GenerateKey <len: int,optional>")]),t._v(": Generate a random key of the specified length")]),t._v(" "),s("li",[s("code",[t._v(".GenerateRSAKey <bits: int,optional>")]),t._v(": Generate a random RSA key of the specified length")]),t._v(" "),s("li",[s("code",[t._v("PersistentSecret <id: string,optional>")]),t._v(": Saves the value of the field in a persistent secret that will be used by the service. (Note the absence of . at the start of the function).")])]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),s("p",[s("code",[t._v("Generate...")]),t._v(" functions will generate different values each time the template is rendered. This will result in constant service restarts.")]),t._v(" "),s("p",[t._v("You should use "),s("code",[t._v("PersistentSecret")]),t._v(" function to store the generated value of the field in a persistent secret.")])]),s("h4",{attrs:{id:"examples"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#examples","aria-hidden":"true"}},[t._v("#")]),t._v(" Examples")]),t._v(" "),s("h5",{attrs:{id:"specify-the-image-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-the-image-version","aria-hidden":"true"}},[t._v("#")]),t._v(" Specify the image version")]),t._v(" "),s("p",[t._v("Provisioned services will use "),s("code",[t._v("version")]),t._v(' as the image tag or "latest" if not specified.')]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(' default .Version "latest" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n")])])]),s("h5",{attrs:{id:"configure-service-url-parameter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-service-url-parameter","aria-hidden":"true"}},[t._v("#")]),t._v(" Configure service URL parameter")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" BASE_URL="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" .Endpoint "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h5",{attrs:{id:"generate-a-random-key-and-save-it-to-the-persistent-secret"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generate-a-random-key-and-save-it-to-the-persistent-secret","aria-hidden":"true"}},[t._v("#")]),t._v(" Generate a random key and save it to the persistent secret")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SECRET_KEY="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" .GenerateKey 30 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" PersistentSecret "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h5",{attrs:{id:"generate-a-random-rsa-key-and-access-it-for-the-different-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generate-a-random-rsa-key-and-access-it-for-the-different-service","aria-hidden":"true"}},[t._v("#")]),t._v(" Generate a random RSA key and access it for the different service")]),t._v(" "),s("p",[t._v('RSA key will be generated and saved in a persistent secret under the "PRIVATE_RSA_KEY" key.')]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SECRET_KEY="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" .GenerateRSAKey 2048 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' PersistentSecret "PRIVATE_RSA_KEY" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./run.sh"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:8080"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SECRET_KEY="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" .GenerateRSAKey 2048 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' PersistentSecret "PRIVATE_RSA_KEY" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"setting-ingress-controller"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-ingress-controller","aria-hidden":"true"}},[t._v("#")]),t._v(" Setting Ingress controller")]),t._v(" "),s("p",[t._v("KuberLogic requires Ingress controller to be expose services to the public internet.")]),t._v(" "),s("p",[t._v("To install Ingress controller, follow Kong installation guide:")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/Kong/kubernetes-ingress-controller",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/Kong/kubernetes-ingress-controller"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Or just run to apply kong ingress controller:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("kubectl apply -f https://bit.ly/k4k8s\n")])])]),s("p",[t._v("Check if you have a default "),s("code",[t._v("ingressClass")]),t._v(" installed:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("kubectl get ingressclasses -o go-template"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{{ range .items }}{{ if eq ( index .metadata.annotations "ingressclass.kubernetes.io/is-default-class" ) "true" }}{{ println .metadata.name }}{{ end }}{{ end }}\'')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Default ingressClass:"')]),t._v("```\n")])])]),s("p",[t._v("If your output is "),s("code",[t._v("Default ingressClass: <ingressClass>")]),t._v(", then you have a default "),s("code",[t._v("ingressClass")]),t._v(" installed.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),s("p",[t._v("You can only have a single default ingressClass.")])]),s("p",[t._v("If you don't have a default "),s("code",[t._v("ingressClass")]),t._v(" installed, you need to set up one:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("\n```bash\nkubectl get ingressclasses\nkubectl annotate ingressclass kong ingressclass.kubernetes.io/is-default-class"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n")])])]),s("p",[s("strong",[t._v("You should change “kong” to your ingressClass name if you use another Ingress controller. You can only have one default "),s("code",[t._v("ingressClass")]),t._v(", so make sure no other ingressClasses marked as default.")])]),t._v(" "),s("h2",{attrs:{id:"configuring-tls-certificate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-tls-certificate","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuring TLS certificate")]),t._v(" "),s("p",[t._v("It is assumed that the TLS certificate will a wildcard certificate. All KuberLogic managed applications share the same certificate via sharing the same ingress controller.")]),t._v(" "),s("p",[t._v("Kuberlogic allows you to secure application access with TLS certificate. Follow the steps below to configure this integration:")]),t._v(" "),s("ol",[s("li",[t._v("Switch to "),s("strong",[t._v("modules/dynamic-operator/config/certificate")]),t._v(" directory and replace the value of tls.crt file (should be plain text TLS certificate) and tls.key (should be plain text TLS private key).")]),t._v(" "),s("li",[t._v("Go to the "),s("strong",[t._v("modules/dynamic-operator")]),t._v(" directory and deploy updated manifests")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deploy\n")])])]),s("h2",{attrs:{id:"enabling-backup-restore-capability"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#enabling-backup-restore-capability","aria-hidden":"true"}},[t._v("#")]),t._v(" Enabling backup/restore capability")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),s("p",[t._v("Backups will only work if you use CSI based volumes. Backups will not work for "),s("code",[t._v("hostPath")]),t._v(" volumes.")])]),s("p",[t._v("Backups and restores feature is provided via "),s("a",{attrs:{href:"https://velero.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("Velero"),s("OutboundLink")],1),t._v(" integration. Both file-based and volume snapshot based backups are supported.\nBackups and restores are disabled by default. Follow these steps to configure environment and enable backup feature:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Get supported Velero release (follow the "),s("a",{attrs:{href:"https://velero.io/docs/v1.9/basic-install/",target:"_blank",rel:"noopener noreferrer"}},[t._v("steps"),s("OutboundLink")],1),t._v(" from the official Velero website)")])]),t._v(" "),s("li",[s("p",[t._v("Install Velero for your "),s("a",{attrs:{href:"https://velero.io/docs/v1.9/supported-providers/",target:"_blank",rel:"noopener noreferrer"}},[t._v("infrastructure provider"),s("OutboundLink")],1),t._v(". Make sure to include "),s("code",[t._v("--use-restic")]),t._v(" to enable file based backups.")])]),t._v(" "),s("li",[s("p",[t._v("Verify Velero status.")])])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("velero version\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Client:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#         Version: v1.9.0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#         Git commit: -")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Server:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#         Version: v1.9.0")]),t._v("\nvelero get backup-locations\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# NAME      PROVIDER   BUCKET/PREFIX     PHASE       LAST VALIDATED                   ACCESS MODE   DEFAULT")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default   aws        kl-demo-backups   Available   2022-07-11 13:54:24 +0300 EEST   ReadWrite     true")]),t._v("\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("Enable and configure backups for KuberLogic\n"),s("ol",[s("li",[t._v("Open file "),s("code",[t._v("modules/dynamic-operator/config/manager/kustomization.yaml")])]),t._v(" "),s("li",[t._v("Change "),s("code",[t._v("backups_enabled=false")]),t._v(" to "),s("code",[t._v("backups_enabled=true")])]),t._v(" "),s("li",[t._v("If your Velero provider plugin supports snapshot based backups, change "),s("code",[t._v("backups_snapshots_enabled=false")]),t._v(" to "),s("code",[t._v("backups_snapshots_enabled=true")])])])])]),t._v(" "),s("h2",{attrs:{id:"billing-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#billing-integration","aria-hidden":"true"}},[t._v("#")]),t._v(" Billing integration")]),t._v(" "),s("p",[t._v("KuberLogic uses webhooks to integrate with various billing providers. Below you can find a scheme of core moving parts of a billing provider integration and instructions on how to set up ChargeBee to work with KuberLogic.\nBilling providers such as ChargeBee have ready-made components that you can easily integrate into your own site (create a pricing table, add products, set up a customer portal).")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/billing_integration.png",alt:""}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Step 1. Software vendors post a pricing table on a product site ("),s("a",{attrs:{href:"https://www.chargebee.com/checkout-portal-docs/drop-in-integration.html#integrating-checkout",target:"_blank",rel:"noopener noreferrer"}},[t._v("Products and checkout"),s("OutboundLink")],1),t._v("). Users can choose a product from the pricing table and proceed to checkout. Also you need to add "),s("a",{attrs:{href:"https://www.chargebee.com/docs/2.0/custom_fields.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("custom field"),s("OutboundLink")],1),t._v(' "domain" (as in example below) that will be updated by KuberLogic once application instance is ready.\n'),s("img",{attrs:{src:"/images/chargebee_custom_field.png",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("Step 2. The billing provider charges the user in accordance with the chosen subscription plan.")])]),t._v(" "),s("li",[s("p",[t._v("Step 3. The billing provider sends an event via Webhook to KuberLogic. 1. "),s("a",{attrs:{href:"https://www.chargebee.com/docs/2.0/api_keys.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("API keys"),s("OutboundLink")],1),t._v(" 2. "),s("a",{attrs:{href:"https://www.chargebee.com/docs/2.0/events_and_webhooks.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webhook"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("Step 4. KuberLogic generates a domain name for the application instance, provisions an application instance in accordance with the chosen subscription plan, and ensures application availability.")])]),t._v(" "),s("li",[s("p",[t._v("Step 5-6. After the application instance is provisioned KuberLogic sends an event to the Billing provider with the application instance domain name information. This event updates the user's subscription with the domain.")])]),t._v(" "),s("li",[s("p",[t._v('Step 7. On the "subscription update," event Billing provider sends an e-mail "Your subscription has been updated" to the User with the application domain name added to the e-mail custom field. You can customize the e-mail template to something like "Your application instance is provisioned!" and add to the template previously created custom field. '),s("a",{attrs:{href:"https://www.chargebee.com/docs/2.0/email-notifications-v2.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Email Notifications"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("Additional. You should add a link to the Customers portal to your application to allow users to manage the subscription "),s("a",{attrs:{href:"https://www.chargebee.com/docs/1.0/customer_portal.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Single Page Customer Portal"),s("OutboundLink")],1)])])]),t._v(" "),s("h3",{attrs:{id:"configuring-kuberlogic-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-kuberlogic-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuring KuberLogic")]),t._v(" "),s("p",[t._v("You should set Chargebee integration params in "),s("code",[t._v("kuberlogic/modules/dynamic-operator/config/manager/kustomization.yaml")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("  - chargebee_site"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  - chargebee_key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  - kuberlogic_domain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n")])])]),s("ul",[s("li",[t._v('"kuberlogic_domain" field is using by KuberLogic to generate subdomains for the application instances (e.g. http://magnetic-llama.example.com,  http://pleasant-antelope.example.com)')])]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("  - chargebee_site"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("example-test\n  - chargebee_key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("test_aTwdMcu4LDMU3eCadmXCJYcubL60tGDYbGeUg\n  - kuberlogic_domain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("example.com\n")])])]),s("p",[t._v("Webhook configuration example:")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/Webhook_example.png",alt:""}})]),t._v(" "),s("p",[s("strong",[t._v('Webhook URL should lead to "kls-chargebee-integration" service External IP.')])]),t._v(" "),s("p",[t._v("Type to see the IP:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("kubectl get svc -n kuberlogic\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#NAME                                     TYPE           CLUSTER-IP   EXTERNAL-IP      PORT(S)        AGE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#kls-api-server                           LoadBalancer   10.8.10.73   34.121.153.159   80:31098/TCP   5h19m")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#kls-chargebee-integration                LoadBalancer   10.8.10.7    34.135.30.100    80:32415/TCP   5h19m")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#kls-controller-manager-metrics-service   ClusterIP      10.8.4.214   <none>           8443/TCP       5h19m")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#kls-webhook-service                      ClusterIP      10.8.15.55   <none>           443/TCP        5h19m")]),t._v("\n")])])])])},[],!1,null,null,null);a.default=n.exports}}]);